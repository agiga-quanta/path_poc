{
  "title": "Data Mining Proof-of-Concept for Program Activity Tracking for Habitat (PATH)",
  "version": "2.0",
  "settings": {
    "pagenumber": 2,
    "editable": true,
    "fullscreenEnabled": true
  },
  "pages": [
    {
      "title": "Status",
      "reports": [
        {
          "title": "Neo4j",
          "query": "CALL dbms.components()\n  YIELD name, versions, edition\nUNWIND versions AS version\nRETURN name, version, edition;",
          "width": 3,
          "type": "table",
          "height": 3,
          "selection": {},
          "settings": {}
        },
        {
          "title": "APOC Library",
          "query": "RETURN apoc.version();\n\n\n",
          "width": "3",
          "type": "value",
          "height": "3",
          "selection": {},
          "settings": {}
        },
        {
          "title": "Graph Data Science",
          "query": "RETURN gds.version();\n\n\n",
          "width": 3,
          "type": "value",
          "height": 3,
          "selection": {},
          "settings": {}
        }
      ]
    },
    {
      "title": "Statistics",
      "reports": [
        {
          "title": "Nodes",
          "query": "MATCH (n)\n  RETURN DISTINCT(LABELS(n)) AS node_label, COUNT(n) AS count\n    ORDER BY node_label, count DESC;\n\n\n",
          "width": "6",
          "type": "table",
          "height": "6",
          "selection": {},
          "settings": {}
        },
        {
          "title": "Relationships",
          "query": "MATCH (s)-[r]->(e)\n  RETURN DISTINCT([LABELS(s)[0], [l IN LABELS(e) WHERE l <> 'NAMED_ENTITY' | l][0]]) AS rel_type, COUNT(r) AS count\n    ORDER BY rel_type, count DESC;\n\n\n\n",
          "width": "6",
          "type": "table",
          "height": "6",
          "selection": {},
          "settings": {}
        }
      ]
    },
    {
      "title": "Foot Prints",
      "reports": [
        {
          "title": "Description",
          "query": "Look for authorizations,\n- with identifications are **17-HCAA-01501**, **17-HCAA-01357**, **17-HCAA-01169**, **16-HCAA-00219**, **17-HCAA-00176**, **15-HCAA-01305**, **14-HCAA-00498**, **16-HCAA-00582**, **17-HCAA-00086**, **17-HCAA-00033**, **18-HCAA-01357**, **17-HCAA-01438**, **17-HCAA-00066**, **17-HCAA-00058**, **17-HCAA-00009**, **16-HCAA-01754**, **16-HCAA-01734**, **16-HCAA-01736**, **16-HCAA-01612**, **16-HCAA-01721**, **17-HCAA-01168**, **17-HCAA-01046**, **14-HCAA-01999**, **14-HCAA-01998**, **14-HCAA-00904**, **14-HCAA-00932**, **14-HCAA-00902**, **14-HCAA-00292**, **17-HCAA-00985**, **17-HCAA-01087**, **17-HCAA-00808**, **17-HCAA-00940**, **17-HCAA-00961**, **17-HCAA-00963**, **15-HCAA-01266**, **18-HCAA-01381**, **18-HCAA-01379**, **18-HCAA-01287**, **18-HCAA-01235**, **18-HCAA-00950**, **18-HCAA-00808**, **18-HCAA-00852**. (This can be changed by the parameter *path_uid*.)\n- has sections (in relations of serious harm to fish) of the description containing at least one of the terms **permanent alteration**, **harmful alteration**, **disruption**, **death of fish**, **temporary alteration**, or **permanent destruction**. (This can be change by the parameter *phrases*).\n- has a foot print, e.g. *50 m2* or *30 ha*, in the same sentence where a specific term, as above, found.\n- extrating the reasons from the sentences if they match given reasons: **dredging**, **rip rap**, **riprap**, **re-sloping**, **piles**,  **realignment**,  **culvert**, **rock fill**, **fill**, **pier**, **instream pier**, **in-stream pier**, **abutment**, **berms**, **armouring**, **concrete pipe**, **extension**, **channel realignment**, **temporary infilling**, **coffer dam**, **cofferdam**, **placement of sand**, **spur**, **bank protection**, **hydraulic impact**, **dewatering**, **changes to flow**, **incidental**, **channel deepening**, **causeway**, and **construction**. (This can be changed by the *reasons* parameter.)",
          "width": "9",
          "type": "text",
          "height": "3",
          "selection": {},
          "settings": {
            "columnWidths": "[10, 5, 50]"
          },
          "parameters": ""
        },
        {
          "title": "Process terms",
          "query": "MERGE (n:PARAM)\n    ON CREATE SET \n        n.impacts = apoc.convert.toJson(custom.extract_terms($impacts, $nlp_url)),\n        n.reasons = apoc.convert.toJson(custom.extract_terms($reasons, $nlp_url))\nRETURN SIZE(n.impacts), SIZE(n.reasons)",
          "width": "3",
          "type": "table",
          "height": "3",
          "selection": {},
          "settings": {},
          "parameters": "{\"impacts\": [\"permanent alteration\", \"harmful alteration\", \"disruption\", \"death of fish\", \"temporary alteration\", \"permanent destruction\"],  \"reasons\": [\"dredging\", \"rip rap\", \"riprap\", \"re-sloping\", \"piles\",  \"realignment\",  \"culvert\", \"rock fill\", \"fill\", \"pier\", \"instream pier\", \"in-stream pier\", \"abutment\", \"berms\", \"armouring\", \"concrete pipe\", \"extension\", \"channel realignment\", \"temporary infilling\", \"coffer dam\", \"cofferdam\", \"placement of sand\", \"spur\", \"bank protection\", \"hydraulic impact\", \"dewatering\", \"changes to flow\", \"incidental\", \"channel deepening\", \"causeway\", \"construction\"], \"nlp_url\": \"http://stanford_nlp:9000/?properties={'outputFormat':'json'}\"}"
        },
        {
          "title": "Total",
          "query": "MATCH (n:PARAM)\nWITH apoc.convert.fromJsonList(n.impacts) AS impacts, apoc.convert.fromJsonList(n.reasons) AS reasons\n    MATCH (doc:PATH)-[r:HAS_SENTENCE {section: $path_section}]-(sentence:SENTENCE)\n        WHERE doc.uid IN $path_uid AND r.item <> $path_item\nWITH impacts, reasons, doc, sentence \n    MATCH (sentence)-[:HAS_FOOT_PRINT]->(foot_print:FOOT_PRINT),\n    (sentence)-[:HAS_KEY_PHRASE]->(key_phrase:KEY_PHRASE)-[:HAS_WORD]->(kword:WORD),\n    (sentence)-[:HAS_KEY_PHRASE]->(reason_phrase:KEY_PHRASE)-[:HAS_WORD]->(rword:WORD)\nWITH impacts, reasons, doc, sentence, foot_print, key_phrase, reason_phrase,\n    COLLECT(kword.lemma) AS kwords, COLLECT(rword.lemma) AS rwords\n    WHERE ANY(term IN impacts WHERE apoc.coll.containsAll(kwords, term))\n    AND ANY(term IN reasons WHERE apoc.coll.containsAll(rwords, term))\nRETURN COUNT(DISTINCT(doc))",
          "width": 3,
          "type": "value",
          "height": 3,
          "selection": {},
          "settings": {},
          "parameters": "{\"path_uid\": [\"17-HCAA-01501\", \"17-HCAA-01357\", \"17-HCAA-01169\", \"16-HCAA-00219\", \"17-HCAA-00176\", \"15-HCAA-01305\", \"14-HCAA-00498\", \"16-HCAA-00582\", \"17-HCAA-00086\", \"17-HCAA-00033\", \"18-HCAA-01357\", \"17-HCAA-01438\", \"17-HCAA-00066\", \"17-HCAA-00058\", \"17-HCAA-00009\", \"16-HCAA-01754\", \"16-HCAA-01734\", \"16-HCAA-01736\", \"16-HCAA-01612\", \"16-HCAA-01721\", \"17-HCAA-01168\", \"17-HCAA-01046\", \"14-HCAA-01999\", \"14-HCAA-01998\", \"14-HCAA-00904\", \"14-HCAA-00932\", \"14-HCAA-00902\", \"14-HCAA-00292\", \"17-HCAA-00985\", \"17-HCAA-01087\", \"17-HCAA-00808\", \"17-HCAA-00940\", \"17-HCAA-00961\", \"17-HCAA-00963\", \"15-HCAA-01266\", \"18-HCAA-01381\", \"18-HCAA-01379\", \"18-HCAA-01287\", \"18-HCAA-01235\", \"18-HCAA-00950\", \"18-HCAA-00808\", \"18-HCAA-00852\"], \"path_section\": \"d\", \"path_item\": \"proj\"}"
        },
        {
          "title": "Project Locations",
          "query": "MATCH (n:PARAM)\nWITH apoc.convert.fromJsonList(n.impacts) AS impacts, apoc.convert.fromJsonList(n.reasons) AS reasons\n    MATCH (doc:PATH)-[r:HAS_SENTENCE {section: $path_section}]-(sentence:SENTENCE)\n        WHERE doc.uid IN $path_uid AND r.item <> $path_item\nWITH impacts, reasons, doc, sentence \n    MATCH (sentence)-[:HAS_FOOT_PRINT]->(foot_print:FOOT_PRINT),\n    (sentence)-[:HAS_KEY_PHRASE]->(key_phrase:KEY_PHRASE)-[:HAS_WORD]->(kword:WORD),\n    (sentence)-[:HAS_KEY_PHRASE]->(reason_phrase:KEY_PHRASE)-[:HAS_WORD]->(rword:WORD)\nWITH impacts, reasons, doc, sentence, foot_print, key_phrase, reason_phrase,\n    COLLECT(kword.lemma) AS kwords, COLLECT(rword.lemma) AS rwords\n    WHERE ANY(term IN impacts WHERE apoc.coll.containsAll(kwords, term))\n    AND ANY(term IN reasons WHERE apoc.coll.containsAll(rwords, term))\nRETURN DISTINCT(doc) AS doc\n\n\n",
          "width": "9",
          "type": "map",
          "height": "6",
          "selection": {
            "PATH": "project_nearest_community"
          },
          "settings": {},
          "parameters": "{\"path_uid\": [\"17-HCAA-01501\", \"17-HCAA-01357\", \"17-HCAA-01169\", \"16-HCAA-00219\", \"17-HCAA-00176\", \"15-HCAA-01305\", \"14-HCAA-00498\", \"16-HCAA-00582\", \"17-HCAA-00086\", \"17-HCAA-00033\", \"18-HCAA-01357\", \"17-HCAA-01438\", \"17-HCAA-00066\", \"17-HCAA-00058\", \"17-HCAA-00009\", \"16-HCAA-01754\", \"16-HCAA-01734\", \"16-HCAA-01736\", \"16-HCAA-01612\", \"16-HCAA-01721\", \"17-HCAA-01168\", \"17-HCAA-01046\", \"14-HCAA-01999\", \"14-HCAA-01998\", \"14-HCAA-00904\", \"14-HCAA-00932\", \"14-HCAA-00902\", \"14-HCAA-00292\", \"17-HCAA-00985\", \"17-HCAA-01087\", \"17-HCAA-00808\", \"17-HCAA-00940\", \"17-HCAA-00961\", \"17-HCAA-00963\", \"15-HCAA-01266\", \"18-HCAA-01381\", \"18-HCAA-01379\", \"18-HCAA-01287\", \"18-HCAA-01235\", \"18-HCAA-00950\", \"18-HCAA-00808\", \"18-HCAA-00852\"], \"path_section\": \"d\", \"path_item\": \"proj\"}"
        },
        {
          "title": "Foot prints and terms",
          "query": "MATCH (n:PARAM)\nWITH apoc.convert.fromJsonList(n.impacts) AS impacts, apoc.convert.fromJsonList(n.reasons) AS reasons\n    MATCH (doc:PATH)-[r:HAS_SENTENCE {section: $path_section}]-(sentence:SENTENCE)\n        WHERE doc.uid IN $path_uid AND r.item <> $path_item\nWITH impacts, reasons, doc, sentence \n    MATCH (sentence)-[:HAS_FOOT_PRINT]->(foot_print:FOOT_PRINT),\n    (sentence)-[:HAS_KEY_PHRASE]->(key_phrase:KEY_PHRASE)-[:HAS_WORD]->(kword:WORD),\n    (sentence)-[:HAS_KEY_PHRASE]->(reason_phrase:KEY_PHRASE)-[:HAS_WORD]->(rword:WORD)\nWITH impacts, reasons, doc, sentence, foot_print, key_phrase, reason_phrase,\n    COLLECT(kword.lemma) AS kwords, COLLECT(rword.lemma) AS rwords\n    WHERE ANY(term IN impacts WHERE apoc.coll.containsAll(kwords, term))\n    AND ANY(term IN reasons WHERE apoc.coll.containsAll(rwords, term))\nRETURN doc.uid, sentence.text AS sentence, foot_print.text AS foot_print,\n    COLLECT(DISTINCT(key_phrase.text)) AS key_phrases, COLLECT(DISTINCT(reason_phrase.text)) AS reason_phrases",
          "width": "12",
          "type": "table",
          "height": "6",
          "selection": {},
          "settings": {
            "columnWidths": "[5, 20, 15, 20, 20]"
          },
          "parameters": "{\"path_uid\": [\"17-HCAA-01501\", \"17-HCAA-01357\", \"17-HCAA-01169\", \"16-HCAA-00219\", \"17-HCAA-00176\", \"15-HCAA-01305\", \"14-HCAA-00498\", \"16-HCAA-00582\", \"17-HCAA-00086\", \"17-HCAA-00033\", \"18-HCAA-01357\", \"17-HCAA-01438\", \"17-HCAA-00066\", \"17-HCAA-00058\", \"17-HCAA-00009\", \"16-HCAA-01754\", \"16-HCAA-01734\", \"16-HCAA-01736\", \"16-HCAA-01612\", \"16-HCAA-01721\", \"17-HCAA-01168\", \"17-HCAA-01046\", \"14-HCAA-01999\", \"14-HCAA-01998\", \"14-HCAA-00904\", \"14-HCAA-00932\", \"14-HCAA-00902\", \"14-HCAA-00292\", \"17-HCAA-00985\", \"17-HCAA-01087\", \"17-HCAA-00808\", \"17-HCAA-00940\", \"17-HCAA-00961\", \"17-HCAA-00963\", \"15-HCAA-01266\", \"18-HCAA-01381\", \"18-HCAA-01379\", \"18-HCAA-01287\", \"18-HCAA-01235\", \"18-HCAA-00950\", \"18-HCAA-00808\", \"18-HCAA-00852\"], \"path_section\": \"d\", \"path_item\": \"proj\"}"
        }
      ]
    },
    {
      "title": "Date Extractions",
      "reports": [
        {
          "title": "Dates extracted from section 5",
          "query": "MATCH (doc:PATH)-[r:HAS_SENTENCE {section: $doc_section}]-(sentence:SENTENCE)\n    WHERE doc.uid STARTS WITH $doc_uid AND r.item STARTS WITH $doc_section_item\nWITH doc, sentence, r.item AS item\n    MATCH (sentence)-[:HAS_NAMED_ENTITY]->(date:NE_DATE)\nWITH doc, item, COLLECT(date.text) AS dates\nRETURN doc.uid AS doc_uid, item, dates ORDER BY doc_uid, item ASC;\n",
          "width": "9",
          "type": "table",
          "height": "3",
          "selection": {},
          "settings": {
            "columnWidths": "[10,5,50]"
          },
          "parameters": "{\"doc_uid\": \"17\", \"doc_section\": \"c\", \"doc_section_item\": \"5.\"}"
        }
      ]
    }
  ]
}